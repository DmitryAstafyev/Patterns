<!DOCTYPE html>
<html>
<head>
    <title></title>
	<meta charset="utf-8" />
    <script type="text/javascript" src="../../../kernel/flex.core.js"></script>
</head>
<body>
    <script>
        function flexPatternTest() {
            var id          = flex.unique(),
                patterns    = flex.libraries.ui.patterns.create(),
                _pattern    = patterns.get({
                url     : '/patterns/popup/pattern.html',
                node    : document.body,
                hooks   : {
                    id      : id,
                    title   : 'Test dialog window',
                    content : patterns.get({
                        url     : '/patterns/patterns/login/pattern.html',
                        hooks   : {
                            login       : patterns.get({
                                url     : '/patterns/controls/textinput/pattern.html',
                                hooks   : {
                                    type: 'text',
                                }
                            }),
                            password    : patterns.get({
                                url     : '/patterns/controls/textinput/pattern.html',
                                hooks   : {
                                    type: 'password',
                                }
                            }),
                            controls    : patterns.get({
                                url     : '/patterns/buttons/flat/pattern.html',
                                hooks   : [{ title: 'login', id: 'login_button' }, { title: 'cancel', id: 'cancel_button' }]
                            }),
                        }
                    })
                },
                callbacks: {
                    success: function (model, binds, map, resources) {
                        var instance = this,
                            clone = null;
                        clone = instance.clone({
                            id: 'clonned_pattern',
                            title: 'Clonned dialog window',
                            content: {
                                login: {
                                    type: 'text',
                                },
                                password: {
                                    type: 'password',
                                },
                                controls: [{ title: 'cloned_login', id: 'login_button' }, { title: 'cloned_cancel', id: 'cancel_button' }],
                            }
                        });
                        document.body.appendChild(clone[0]);
                        var movement = flex.libraries.ui.window.move.create(),
                            resize = flex.libraries.ui.window.resize.create();
                        movement.init();
                        resize.init();
                        binds.__content__.__login__.value.addHandle(function (arg1, arg2, arg3) {
                            window.console.log('__login__::: arg1:: ' + arg1 + ' ------ arg2:: ' + arg2);
                        });
                        binds.__content__.__password__.value.addHandle(function (arg1, arg2, arg3) {
                            window.console.log('__password__::: arg1:: ' + arg1 + ' ------ arg2:: ' + arg2);
                        });
                        _node('a[id="login_button"]').events().add('click', function () {
                            var inputs = _nodes('*[data-flex-ui-window-resize-container="' + id + '"] input[name="TestInput"]').target;
                            Array.prototype.forEach.call(inputs, function (input) {
                                input.setAttribute('value', performance.now());
                                //input.value = performance.now();
                            });
                            _node('p[id="test_bottom_id"]').target.innerHTML = performance.now();
                            window.console.log('bottom:: ' + this.bottom);
                            window.console.log('__login__.value:: ' + this.__content__.__login__.value);
                            window.console.log('__password__.value:: ' + this.__content__.__password__.value);
                        }.bind(model));
                    }
                }
            }).render();
        };
        flexPatternTest.include = [
            'ui.window.move',
            'ui.window.resize',
        ];
        flexPatternTest.exclude = [
            'flex.presentation',
        ];
    </script>
</body>
</html>
